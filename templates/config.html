{% extends "base.html" %}

{% block title %}Configuration - Moneybags{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8">
        <h2 class="mb-4">Configuration</h2>

        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-currency-dollar me-2"></i>Currency settings</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label for="currencyFormat" class="form-label">Currency format</label>
                    <select class="form-select" id="currencyFormat">
                        <option value="nok" selected>NOK (kr)</option>
                        <option value="usd">USD ($)</option>
                        <option value="eur">EUR (â‚¬)</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="bi bi-tag me-2"></i>Categories</h5>
                <button class="btn btn-sm btn-primary" onclick="openAddCategoryModal()">
                    <i class="bi bi-plus-circle me-1"></i>Add category
                </button>
            </div>
            <div class="card-body">
                <p class="text-muted mb-3">Manage income and expense categories available across all years.</p>
                <div class="table-responsive">
                    <table class="table table-hover" id="categoriesTable">
                        <thead>
                            <tr>
                                <th>Category Name</th>
                                <th>Type</th>
                                <th>Used in Years</th>
                                <th class="text-end">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="bi bi-person me-2"></i>Payees</h5>
                <button class="btn btn-sm btn-primary" onclick="openAddPayeeModal()">
                    <i class="bi bi-plus-circle me-1"></i>Add payee
                </button>
            </div>
            <div class="card-body">
                <p class="text-muted mb-3">Manage payees that appear in your transactions.</p>
                <div class="mb-3">
                    <input type="text" class="form-control" id="payeeSearch" placeholder="Search payees..." onkeyup="filterPayees()">
                </div>
                <div class="table-responsive">
                    <table class="table table-hover" id="payeesTable">
                        <thead>
                            <tr>
                                <th>Payee Name</th>
                                <th># Transactions</th>
                                <th>Last Used</th>
                                <th class="text-end">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Category Modal -->
<div class="modal fade" id="categoryModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="categoryModalTitle">Add Category</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="categoryForm">
                    <div class="mb-3">
                        <label for="categoryName" class="form-label">Category Name</label>
                        <input type="text" class="form-control" id="categoryName" required>
                    </div>
                    <div class="mb-3">
                        <label for="categoryType" class="form-label">Type</label>
                        <select class="form-select" id="categoryType" required>
                            <option value="">Select type...</option>
                            <option value="income">Income</option>
                            <option value="expenses">Expenses</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveCategory()">Save</button>
            </div>
        </div>
    </div>
</div>

<!-- Payee Modal -->
<div class="modal fade" id="payeeModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="payeeModalTitle">Add Payee</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="payeeForm">
                    <div class="mb-3">
                        <label for="payeeName" class="form-label">Payee Name</label>
                        <input type="text" class="form-control" id="payeeName" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="savePayee()">Save</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
